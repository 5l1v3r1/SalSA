"""
Generates report from alerts generated by rules
"""
import sys

# local modules
import pe

# directory of rules
import rules

# import rules
for r in rules.__all__:
  __import__('rules.' + r)

print '#' * 80
print 'File: ' + sys.argv[1]
print '#' * 80

alerts = []
# parse the file specified at the comand line
obj = pe.PE(sys.argv[1], True)

for r in rules.__all__:
  alerts.extend(sys.modules['rules.' + r].run(obj))

if alerts:
  for a in alerts:
    print(a)
    # display delimiter
    print('-' * 80)
